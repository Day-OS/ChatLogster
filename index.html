
<body>
    <main>
        <div class="logo">
            <a href="https://day-os.github.io/ChatLogster/"><img src="https://raw.githubusercontent.com/Day-OS/ChatLogster/main/assets/chatlogster.svg" id="logo"></a>
        </div>

        <div class="serverselection" style=>
            <h2>ChatLogster</h2>
            <br>
            <hr>
            <div class="serversoption">
                
            <input name="RPServer" type="radio" id="BL" checked="checked" style="display: none;" onchange="ChangeServer('BL')">
            <label for="BL" id="BLL">
                <img class="RPServer" width="100%" src="https://cdn.blaine.life/static/images/forum/blaine-logo.png" alt="BlaineLife">

            </label>
            <input name="RPServer" type="radio" id="AD" style="display: none;" onchange="ChangeServer('AD')"> 
            <label for="AD" id="ADL">
                <img name="RPServer" class="RPServer" width="100%" src="https://forum.advanced-roleplay.com.br/styles/marina_slate/theme/images/logo2.png" alt="AdvancedRoleplay">
            </label>

            </div>
        </div>

        <div class="filesimport">
            <br>
            <textarea name="" id="textareainput" cols="60" rows="10" onchange="generateImage()">Escreva aqui como no exemplo, o site cuidará do resto.
[00:00] chat_log: * John Doe observa as estrelas. 
chat_log: > Jane Doe olha pra John e o abraça.
            </textarea>
            <div class="import-buttons">
                <label for="fileinput" class="fileinputbutton">Adicionar um txt/log <u>não</u> editado</label>
                <input type="range" value="13" min="13" max="100" id="fontsize-range" onchange="FontSizeChange(); generateImage();">
                <input type="file" accept=".txt, .log" id="fileinput" style="display: none;" onchange="LoadFile()">
            </div>
        </div>
        <a id="canvaslink">
            <div class="canvas">
                <canvas id="textResult" width="200" height="100" style="image-rendering: pixelated;"></canvas>
            </div>
        </a>
        <div class="rodape">
            <a href="https://raw.githubusercontent.com/Day-OS/ChatLogster/main/index.html">Baixe o ChatLogster</a>
            <a href="https://github.com/Day-OS/ChatLogster">Repositório do Github</a>

        </div>
    </main>
    <br>
    <br>
</body>

<head>
    <meta charset="utf-8"> 
    <link rel="stylesheet" href="https://meyerweb.com/eric/tools/css/reset/reset.css">
    <style>
        a{
            text-decoration: none;
            color: black;
        }
        .rodape, .rodape a{
            text-decoration: none;
            text-align: center;
            color: black;
            font-family: sans-serif;
            font-weight: bolder;
            padding: 10px;
            margin-top: 80px;
            border-radius: 10px;
            height: 20px;
        }
        .rodape a{
            background-color: #4deb74;
        }
        .rodape a:hover{
            background-color: rgb(91, 199, 118);
        }
        .import-buttons{
            margin-top: calc(8px + 10%);
            float: right;
            align-content: center;
            text-align: center;
            display: block;
        }
        #fontsize-range{
            margin-top: 20px;
            width: 100%;
            display: block;
            border-radius: 5px;
            appearance: none;
        }
        #fontsize-range::-webkit-slider-thumb{
            -webkit-appearance: none; /* Override default look */
            appearance: none;
            width: 30px;
            height: 30px;
            border-radius: 5px;
            background: #4deb74;
            cursor: pointer;
        }
        hr{
            filter: blur(1px);
            border-width: 2px;
            border-radius: 66%;
            border-color: rgba(0, 0, 0, 0.336);
        }
        .serversoption{
            text-align: center;
        }
        .RPServer{
            margin-left: auto;
            margin-right: auto;
            display: inline-block;
            text-align: center;
            width: 20%;
        }
        #ADL, #BLL{
            filter: blur(2px);
        }
        #BL:checked + #BLL, #AD:checked + #ADL{
            filter: none;
        }
        @font-face {
            font-family: SigmarOneRegular;
            src: url(https://github.com/Day-OS/ChatLogster/raw/main/assets/SigmarOne-Regular.ttf);
        }
        h2{
            text-align: center;
            color: white;
            font-size: 70px;
            -webkit-text-stroke-color: black;
            -webkit-text-stroke-width: 2px;
            font-family: Knewave;
            font-weight: bolder;
        }
        .filesimport, .serversoption{
            display: block;
            width: 50%;
            margin-left: auto;
            margin-right: auto;
        }
        textarea{
            width: 400px;
            height: 200px;
            font-family: sans-serif;
            border-radius: 6px;
            border-bottom-width: 4px;
            border-right-width: 4px;
            border-color: rgb(0, 0, 0);
            padding: 8px;
            resize: none;
        }
        textarea:focus {
            outline: none;
        }
        
        #logo{
            padding: 8px;
            filter: 
            drop-shadow(1px 1px 0 rgb(255, 255, 255)) 
            drop-shadow(2px 2px 0 rgb(255, 255, 255)) 
            drop-shadow(1px -1px 0 rgb(255, 255, 255)) 
            drop-shadow(-1px 1px 0 rgb(255, 255, 255)) 
            drop-shadow(-1px -1px 0 rgb(255, 255, 255));
            display: block;
            width: 50%;
            margin-left: auto;
            margin-right: auto;
            width: 200px;
        }
        .fileinputbutton, button{
            border-width: 0;
            font-family: sans-serif;
            font-weight: bolder;
            font-style: oblique;
            padding: 10px;
            margin-top: 80px;
            border-radius: 20px;
            height: 20px;
            background-color: #4deb74;
        }
        .fileinputbutton:hover, button:hover{
            
            background-color: rgb(91, 199, 118);
        }
        body{
            background-image: url(https://github.com/Day-OS/ChatLogster/raw/main/assets/background.png);
        }
        .canvas{
            cursor:grab;
            background-color: rgba(0, 0, 0, 0.267);
            border-width: 2px;
            border-bottom-style: solid;
            border-radius: 4px;
            margin-left: auto;
            width: 800;
            height: 600;
            margin-right: auto;
            overflow-y: scroll;

        }
        .canvas:hover{
            background-color: rgba(49, 49, 49, 0.267);

        }

        ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
        }
        ::-webkit-scrollbar-track, ::-webkit-scrollbar-colorner{
        border-radius: 4px;
        background: #00000000; 
        }
        ::-webkit-scrollbar-thumb {
        border-radius: 4px;
        background: rgb(36, 36, 36); 
        }
        ::-webkit-scrollbar-thumb:hover {
        background: #555; 
        }
        
    </style>
<script>
    var fontSizeGlobal = 13
    
    var textQuantity = 0
    function CreateText(text, color, x, y){
        if(color == '#000000'){
            color = lastcolor
        }
        canvas.fillStyle = color
        canvas.lineWidth = 2;
        canvas.font = "bold "+fontSizeGlobal+"px Arial";
        for(var i= 0; i<15; i++){canvas.strokeText(text, x, y);}
        canvas.font = "bold "+fontSizeGlobal+"px Arial";
        canvas.fillText(text, x, y);
        textQuantity++;
        lastcolor = color
        
    }

    function ChangeServer(server){
        text = document.getElementById('textareainput');
        switch(server){
        case 'BL':
            text.value = "[00:00] chat_log: * John Doe observa as estrelas. \nchat_log: > Jane Doe olha pra John e o abraça."
        break;
        case 'AD':
            text.value = "[00:00] * John Doe observa as estrelas. \n> Jane Doe olha pra John e o abraça."
            break;
        }
        generateImage()

    }
    const reader = new FileReader()
    reader.onload = event => {
        result = event.target.result
        if(document.getElementById('BL').checked){ 
            input = result.split("\n")
            for(var i = 0; i < input.length; i++){
                    line = input[i].split("] ")
                    if(line.length == 1){line[1] = line[0]; line[0] = "["}
                    if(!line[1].startsWith("chat_log")){}
                    else{
                        line.shift();
                        line = line.join("]")
                        inputtemp.push(line)}
                }
            result = inputtemp.join("\n")
        }
        document.getElementById("textareainput").value = result;
        generateImage()
    }

    function LoadFile(){
        files = document.getElementById("fileinput").files
        if(document.getElementById('BL').checked){encode = "utf-8"} else{encode = "iso-8859-1"}
        if(files.length>=1){
            reader.readAsText(files[0], encode)
        }
    }
    
    function FontSizeChange(){
        fontSizeGlobal = parseInt(document.getElementById("fontsize-range").value)
    }

    function generateImage(){
        var input = document.getElementById("textareainput").value
        canvas = document.getElementById("textResult").getContext("2d");
        input = input.split("\n")
        lastcolor = "#FFFFFF"
        inputtemp = []
        var mode = "BL";

        if(document.getElementById("BL").checked){mode = "BL"}
        if(document.getElementById("AD").checked){mode = "AD"}
        switch(mode)
        {
            case "BL":
                biggestline = 0
                for(var i = 0; i < input.length; i++){
                    line = input[i].split("] ")
                    if(line.length == 1){line[1] = line[0]; line[0] = "["}
                    if(!line[1].startsWith("chat_log")){}
                    else{
                        line.shift();
                        line = line.join("]")
                        line = line.replaceAll("chat_log: ", "")
                        if(line.length > biggestline){biggestline = line.length};
                        inputtemp.push(line)}
                }
                input = inputtemp
                document.getElementById('textResult').width = fontSizeGlobal*biggestline/2;
                document.getElementById('textResult').height = fontSizeGlobal*input.length*1.2;
                for(var i = 0; i< input.length; i++){
                    line = input[i].split("] ");
                    if(line.length == 1){line = line[0]}else{line = line[1]}

                    if(line.startsWith("(( [")){
                        color = '#aaaaaa'
                    }
                    else if(line.startsWith("(( PM") /*|| line.split("(celular)").length > 1*/ || line.startsWith("SMS de") || line.startsWith("#")){
                        color = '#ffdc18'
                    }

                    else if(line.startsWith("* ") || line.startsWith("> ") || !line.startsWith("((") && line.endsWith(" ))")){
                        color = '#bb9cd2'
                    }
                    else if(line.startsWith("...")){
                        color =  lastcolor
                    }
                    

                    else if(line.startsWith("** ")){
                        if(line.startsWith("** Jogador")||line.startsWith("** Tester")||line.startsWith("** Admin")||line.startsWith("** Novato")){
                        color = '#0195ef'
                        }
                        else{
                            color = '#bb9cd2'
                        }
                    }
                    else if(line.startsWith("[")){
                        if(line.startsWith("[Anúncio]")){
                        color = '#33aa33'
                        }
                        else if(line.startsWith("[Confronto]") || line.startsWith("[Ações]") || line.startsWith("[MICROFONE")){
                        color = '#ece641'
                        }
                        else if(line.startsWith("[baixo") || line.startsWith("[DENTRO")){
                            color = '#aaaaaa'
                        }
                        else if(line.startsWith("[XM Radio]")){
                        color = '#88aa62'
                        }
                        else{
                            color = lastcolor
                        }
                    }
                    
                    else if(line.startsWith("AdmCmd")){
                        color = '#c4514b'
                    }

                    else{
                        color = '#FFFFFF'
                    }
                    CreateText(input[i], color, 4, fontSizeGlobal* (i *1.2)+ fontSizeGlobal)
                }
                break;
            case "AD":
                for(var i = 0; i < input.length; i++){
                input[i] = input[i].replaceAll("↵", "");
                input[i] = input[i].replaceAll("\n", "");
                if(input[i].endsWith("]") || input[i].endsWith("] ")){} else if(input[i] == ""){} else{inputtemp.push(input[i])}
                 }
                input = inputtemp
                document.getElementById('textResult').width = fontSizeGlobal*51;
                document.getElementById('textResult').height = fontSizeGlobal*input.length*1.2;
            
                for(var i = 0; i< input.length; i++){
                    line = input[i].split("] ");
                    if(line.length == 1){line = line[0]}else{line = line[1]}
                    if(line.startsWith("* ") || line.startsWith("> ")){
                        color = '#bb9cd2'
                    }
                    else if(line.startsWith("...")){
                        color =  lastcolor
                    }
                    else if(line.startsWith("(( [")){
                        color = '#aaaaaa'
                    }

                    else if(line.startsWith("** ")){
                        if(line.startsWith("** Jogador")||line.startsWith("** Tester")||line.startsWith("** Admin")||line.startsWith("** Novato")){
                        color = '#0195ef'
                        }
                        else{
                            color = '#ece641'
                        }
                    }
                    else if(line.startsWith("[")){
                        if(line.startsWith("[Confronto]") || line.startsWith("[Ações]") || line.startsWith("[MICROFONE")){
                        color = '#ece641'
                        }
                        else if(line.startsWith("[baixo") || line.startsWith("[DENTRO")){
                            color = '#aaaaaa'
                        }
                        else{
                            color = '#33aa33'
                        }
                    }
                    else if(line.startsWith("Audio stream")){
                        color = '#88aa62'
                    }
                    else if(line.startsWith("AdmCmd")){
                        color = '#c4514b'
                    }

                    else{
                        color = '#FFFFFF'
                    }
                    CreateText(input[i], color, 4, fontSizeGlobal*(i *1.2)+fontSizeGlobal)
                }
                break;

        }
        filename = "chatLogsterRender.png"
        document.getElementById("canvaslink").setAttribute("href", document.getElementById("textResult").toDataURL("image/png"))
        document.getElementById("canvaslink").setAttribute("download", filename)

    }
    generateImage()
</script>
</head>